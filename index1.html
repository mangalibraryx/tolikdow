<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TikTok Downloader - Download Videos Without Watermark</title>
    <meta name="description" content="100% Working TikTok video downloader. Download videos in HD quality without watermark. No limits, completely free.">
    
    <style>
        :root {
            --primary: #FF0050;
            --secondary: #00F2EA;
            --dark: #121212;
            --light: #ffffff;
            --gray: #f5f5f5;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--dark);
            color: var(--light);
            min-height: 100vh;
            background: linear-gradient(135deg, #000000 0%, #1a1a2e 100%);
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* Header */
        header {
            text-align: center;
            padding: 40px 20px;
        }
        
        .logo {
            font-size: 48px;
            font-weight: 900;
            margin-bottom: 10px;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }
        
        .logo i {
            font-size: 56px;
        }
        
        .tagline {
            font-size: 18px;
            color: #aaa;
            margin-bottom: 30px;
        }
        
        /* Main Download Area */
        .download-area {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            margin: 30px auto;
            max-width: 800px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .input-group {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        #tiktokUrl {
            flex: 1;
            padding: 18px 25px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            color: white;
            font-size: 16px;
            outline: none;
            transition: all 0.3s;
        }
        
        #tiktokUrl:focus {
            border-color: var(--primary);
            box-shadow: 0 0 20px rgba(255, 0, 80, 0.2);
        }
        
        #downloadBtn {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            border-radius: 15px;
            padding: 0 40px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        #downloadBtn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(255, 0, 80, 0.3);
        }
        
        #downloadBtn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        .examples {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
        }
        
        .example-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #aaa;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .example-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }
        
        /* Results */
        .results {
            display: none;
            margin-top: 40px;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .video-info {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .video-preview {
            display: flex;
            gap: 30px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .thumbnail-container {
            flex: 0 0 200px;
        }
        
        .thumbnail {
            width: 100%;
            border-radius: 10px;
            aspect-ratio: 9/16;
            object-fit: cover;
            border: 3px solid rgba(255, 255, 255, 0.1);
        }
        
        .video-details {
            flex: 1;
            min-width: 300px;
        }
        
        .video-title {
            font-size: 22px;
            margin-bottom: 10px;
            color: white;
        }
        
        .video-author {
            color: var(--secondary);
            font-size: 16px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .download-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        
        .download-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s;
        }
        
        .download-card:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.08);
            border-color: var(--primary);
        }
        
        .quality-badge {
            display: inline-block;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 15px;
        }
        
        .download-link {
            display: block;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            color: white;
            text-align: center;
            padding: 15px;
            border-radius: 10px;
            text-decoration: none;
            font-weight: 600;
            margin-top: 15px;
            transition: all 0.3s;
        }
        
        .download-link:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 25px rgba(255, 0, 80, 0.3);
        }
        
        /* Features */
        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            margin: 60px 0;
        }
        
        .feature-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .feature-icon {
            font-size: 40px;
            margin-bottom: 20px;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        /* Steps */
        .steps {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 40px;
            margin: 60px 0;
        }
        
        .step {
            text-align: center;
            flex: 1;
            min-width: 200px;
            max-width: 300px;
        }
        
        .step-number {
            width: 60px;
            height: 60px;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: bold;
            margin: 0 auto 20px;
        }
        
        /* Footer */
        footer {
            text-align: center;
            padding: 40px 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            margin-top: 60px;
        }
        
        .disclaimer {
            background: rgba(255, 0, 80, 0.1);
            border: 1px solid rgba(255, 0, 80, 0.3);
            border-radius: 10px;
            padding: 20px;
            margin: 30px auto;
            max-width: 800px;
            font-size: 14px;
            color: #aaa;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .input-group {
                flex-direction: column;
            }
            
            #downloadBtn {
                padding: 18px;
                justify-content: center;
            }
            
            .download-area {
                padding: 25px;
            }
            
            .logo {
                font-size: 36px;
            }
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }
        
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <header>
            <h1 class="logo">
                <i class="fab fa-tiktok"></i>
                TikTokDownloader
            </h1>
            <p class="tagline">Download TikTok Videos in HD Quality Without Watermark</p>
        </header>
        
        <main class="download-area">
            <h2 style="text-align: center; margin-bottom: 30px; font-size: 28px;">
                Paste TikTok Link Below
            </h2>
            
            <div class="input-group">
                <input 
                    type="url" 
                    id="tiktokUrl"
                    placeholder="Paste TikTok video URL here..."
                    autocomplete="off"
                >
                <button id="downloadBtn">
                    <i class="fas fa-download"></i> Download Now
                </button>
            </div>
            
            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p>Processing your video...</p>
            </div>
            
            <div class="examples">
                <div class="example-btn" onclick="useExample('https://www.tiktok.com/@tiktok/video/7292766767393180960')">
                    Example 1
                </div>
                <div class="example-btn" onclick="useExample('https://vm.tiktok.com/ZMjPqQxYr/')">
                    Example 2
                </div>
                <div class="example-btn" onclick="useExample('https://www.tiktok.com/@example/video/123456789')">
                    Example 3
                </div>
            </div>
            
            <div class="results" id="results">
                <div class="video-info">
                    <div class="video-preview">
                        <div class="thumbnail-container">
                            <img id="videoThumb" class="thumbnail" src="" alt="Video Thumbnail">
                        </div>
                        <div class="video-details">
                            <h3 id="videoTitle" class="video-title"></h3>
                            <div id="videoAuthor" class="video-author">
                                <i class="fas fa-user"></i>
                            </div>
                            <div style="margin-top: 20px;">
                                <p style="color: #aaa; margin-bottom: 5px;">Video Info:</p>
                                <div style="display: flex; gap: 20px; flex-wrap: wrap;">
                                    <span><i class="fas fa-clock"></i> <span id="videoDuration">0:00</span></span>
                                    <span><i class="fas fa-eye"></i> <span id="videoViews">0</span> views</span>
                                    <span><i class="fas fa-heart"></i> <span id="videoLikes">0</span></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <h3 style="margin-bottom: 20px; font-size: 22px;">Download Options:</h3>
                <div class="download-options" id="downloadOptions">
                    <!-- Download options will be inserted here -->
                </div>
            </div>
        </main>
        
        <div class="features">
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-bolt"></i>
                </div>
                <h3>100% Working</h3>
                <p>Our service is always updated to work with latest TikTok changes</p>
            </div>
            
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-shield-alt"></i>
                </div>
                <h3>No Watermark</h3>
                <p>Download videos without TikTok watermark for clean sharing</p>
            </div>
            
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-mobile-alt"></i>
                </div>
                <h3>All Devices</h3>
                <p>Works on iPhone, Android, PC, and Mac without any app</p>
            </div>
            
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-infinity"></i>
                </div>
                <h3>Unlimited Downloads</h3>
                <p>No limits on downloads. Download as many videos as you want</p>
            </div>
        </div>
        
        <div class="steps">
            <div class="step">
                <div class="step-number">1</div>
                <h3>Copy TikTok URL</h3>
                <p>Go to TikTok app, tap share button and copy video link</p>
            </div>
            
            <div class="step">
                <div class="step-number">2</div>
                <h3>Paste Link</h3>
                <p>Paste the copied link in the input field above</p>
            </div>
            
            <div class="step">
                <div class="step-number">3</div>
                <h3>Download</h3>
                <p>Choose quality and download without watermark instantly</p>
            </div>
        </div>
        
        <footer>
            <div class="disclaimer">
                <p><strong>Disclaimer:</strong> This tool is for personal use only. Please respect copyrights and only download videos you have permission to use or that are in the public domain. We are not responsible for any misuse of this service.</p>
            </div>
            <p>&copy; 2024 TikTokDownloader. All rights reserved.</p>
            <p style="margin-top: 10px; color: #aaa; font-size: 14px;">
                This is an independent service and is not affiliated with TikTok.
            </p>
        </footer>
    </div>

    <script>
        // Configuration
        const API_ENDPOINTS = {
            // Primary API - Using a working TikTok downloader API
            'primary': 'https://api.tiklydown.eu.org/api/download',
            // Fallback API
            'fallback': 'https://www.tikwm.com/api/',
            // Alternative API
            'alternative': 'https://tikdown.org/getVideo'
        };

        // DOM Elements
        const tiktokUrlInput = document.getElementById('tiktokUrl');
        const downloadBtn = document.getElementById('downloadBtn');
        const loadingDiv = document.getElementById('loading');
        const resultsDiv = document.getElementById('results');
        const downloadOptionsDiv = document.getElementById('downloadOptions');
        
        // Example URLs
        function useExample(url) {
            tiktokUrlInput.value = url;
            downloadBtn.click();
        }
        
        // Validate TikTok URL
        function isValidTikTokUrl(url) {
            const patterns = [
                /tiktok\.com\/@[\w.-]+\/video\/\d+/,
                /vm\.tiktok\.com\/\w+\//,
                /vt\.tiktok\.com\/\w+\//,
                /tiktok\.com\/t\/\w+\//
            ];
            
            return patterns.some(pattern => pattern.test(url));
        }
        
        // Extract video ID from URL
        function extractVideoId(url) {
            try {
                // Handle different URL formats
                if (url.includes('/video/')) {
                    const match = url.match(/\/video\/(\d+)/);
                    return match ? match[1] : null;
                }
                
                // For shortened URLs, we'll use the full URL
                return null;
            } catch (error) {
                return null;
            }
        }
        
        // Show loading state
        function showLoading() {
            loadingDiv.style.display = 'block';
            resultsDiv.style.display = 'none';
            downloadBtn.disabled = true;
            downloadBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
        }
        
        // Hide loading state
        function hideLoading() {
            loadingDiv.style.display = 'none';
            downloadBtn.disabled = false;
            downloadBtn.innerHTML = '<i class="fas fa-download"></i> Download Now';
        }
        
        // Format file size
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }
        
        // Display video information
        function displayVideoInfo(videoData) {
            document.getElementById('videoTitle').textContent = 
                videoData.title || 'TikTok Video';
            
            document.getElementById('videoAuthor').innerHTML = 
                `<i class="fas fa-user"></i> ${videoData.author || '@user'}`;
            
            document.getElementById('videoThumb').src = 
                videoData.thumbnail || 'https://via.placeholder.com/200x356/FF0050/ffffff?text=TikTok';
            
            document.getElementById('videoDuration').textContent = 
                videoData.duration || '0:00';
            
            document.getElementById('videoViews').textContent = 
                videoData.views ? videoData.views.toLocaleString() : '0';
            
            document.getElementById('videoLikes').textContent = 
                videoData.likes ? videoData.likes.toLocaleString() : '0';
        }
        
        // Create download options
        function createDownloadOptions(videoData) {
            downloadOptionsDiv.innerHTML = '';
            
            // HD Download Option
            if (videoData.hd) {
                const hdCard = document.createElement('div');
                hdCard.className = 'download-card';
                hdCard.innerHTML = `
                    <span class="quality-badge">HD QUALITY</span>
                    <h4>High Definition (No Watermark)</h4>
                    <p><i class="fas fa-video"></i> Best quality video without watermark</p>
                    <p><i class="fas fa-database"></i> Size: ${videoData.hd_size || 'Large'}</p>
                    <a href="${videoData.hd}" class="download-link" download="tiktok-hd-video.mp4">
                        <i class="fas fa-download"></i> Download HD Video
                    </a>
                `;
                downloadOptionsDiv.appendChild(hdCard);
            }
            
            // SD Download Option
            if (videoData.sd) {
                const sdCard = document.createElement('div');
                sdCard.className = 'download-card';
                sdCard.innerHTML = `
                    <span class="quality-badge">SD QUALITY</span>
                    <h4>Standard Definition (No Watermark)</h4>
                    <p><i class="fas fa-video"></i> Good quality with smaller file size</p>
                    <p><i class="fas fa-database"></i> Size: ${videoData.sd_size || 'Medium'}</p>
                    <a href="${videoData.sd}" class="download-link" download="tiktok-sd-video.mp4">
                        <i class="fas fa-download"></i> Download SD Video
                    </a>
                `;
                downloadOptionsDiv.appendChild(sdCard);
            }
            
            // Watermarked Version
            if (videoData.watermarked) {
                const wmCard = document.createElement('div');
                wmCard.className = 'download-card';
                wmCard.innerHTML = `
                    <span class="quality-badge">WITH WATERMARK</span>
                    <h4>Original TikTok Video</h4>
                    <p><i class="fas fa-water"></i> Original video with TikTok watermark</p>
                    <p><i class="fas fa-database"></i> Size: ${videoData.wm_size || 'Small'}</p>
                    <a href="${videoData.watermarked}" class="download-link" download="tiktok-original-video.mp4">
                        <i class="fas fa-download"></i> Download Original
                    </a>
                `;
                downloadOptionsDiv.appendChild(wmCard);
            }
            
            // Audio Only Option
            if (videoData.audio) {
                const audioCard = document.createElement('div');
                audioCard.className = 'download-card';
                audioCard.innerHTML = `
                    <span class="quality-badge">AUDIO ONLY</span>
                    <h4>MP3 Audio File</h4>
                    <p><i class="fas fa-music"></i> Extract audio as MP3 file</p>
                    <p><i class="fas fa-database"></i> Size: ${videoData.audio_size || 'Small'}</p>
                    <a href="${videoData.audio}" class="download-link" download="tiktok-audio.mp3">
                        <i class="fas fa-download"></i> Download MP3 Audio
                    </a>
                `;
                downloadOptionsDiv.appendChild(audioCard);
            }
            
            // Direct Download Button
            const directCard = document.createElement('div');
            directCard.className = 'download-card';
            directCard.style.gridColumn = '1 / -1';
            directCard.innerHTML = `
                <h4>Direct Download Methods</h4>
                <p>If the buttons above don't work, try these direct methods:</p>
                <div style="display: flex; gap: 15px; margin-top: 15px; flex-wrap: wrap;">
                    <button onclick="downloadViaAPI('${encodeURIComponent(tiktokUrlInput.value)}')" 
                            style="padding: 10px 20px; background: var(--primary); border: none; border-radius: 8px; color: white; cursor: pointer;">
                        Method 1: API Download
                    </button>
                    <button onclick="openInNewTab('${tiktokUrlInput.value}')"
                            style="padding: 10px 20px; background: var(--secondary); border: none; border-radius: 8px; color: white; cursor: pointer;">
                        Method 2: Browser Extension
                    </button>
                </div>
            `;
            downloadOptionsDiv.appendChild(directCard);
        }
        
        // Alternative download methods
        function downloadViaAPI(url) {
            // Use a third-party API service
            const apiUrl = `https://api.tiklydown.eu.org/api/download?url=${encodeURIComponent(url)}`;
            window.open(apiUrl, '_blank');
        }
        
        function openInNewTab(url) {
            // Open in a new tab with download instructions
            const instructions = `
                <html>
                    <body>
                        <h1>Download Instructions</h1>
                        <p>Add "ss" before tiktok.com in the URL like this:</p>
                        <p>Original: ${url}</p>
                        <p>Modified: ${url.replace('tiktok.com', 'sstiktok.com')}</p>
                        <p>Or use: ${url.replace('tiktok.com', 'tiktx.com')}</p>
                    </body>
                </html>
            `;
            
            const newWindow = window.open();
            newWindow.document.write(instructions);
        }
        
        // Main download function
        async function downloadVideo() {
            const url = tiktokUrlInput.value.trim();
            
            if (!url) {
                alert('Please enter a TikTok URL');
                return;
            }
            
            if (!isValidTikTokUrl(url)) {
                alert('Please enter a valid TikTok URL. Examples:\n\n' +
                      'https://www.tiktok.com/@username/video/123456789\n' +
                      'https://vm.tiktok.com/ZMjPqQxYr/');
                return;
            }
            
            showLoading();
            
            try {
                // Try multiple APIs until one works
                const videoData = await tryMultipleAPIs(url);
                
                if (videoData) {
                    displayVideoInfo(videoData);
                    createDownloadOptions(videoData);
                    resultsDiv.style.display = 'block';
                    resultsDiv.scrollIntoView({ behavior: 'smooth' });
                } else {
                    throw new Error('All download methods failed');
                }
            } catch (error) {
                console.error('Download error:', error);
                alert('Failed to download video. Try these solutions:\n\n' +
                      '1. Check if the video is available\n' +
                      '2. Try a different URL format\n' +
                      '3. Use Method 1 or 2 below\n' +
                      '4. Try again in a few minutes');
                
                // Show alternative methods
                resultsDiv.style.display = 'block';
                downloadOptionsDiv.innerHTML = `
                    <div class="download-card" style="grid-column: 1 / -1;">
                        <h3>Alternative Download Methods</h3>
                        <p>Try these working methods:</p>
                        <div style="margin-top: 20px;">
                            <h4>Method 1: Use Different Websites</h4>
                            <p>Try these working TikTok downloaders:</p>
                            <div style="display: flex; gap: 10px; margin-top: 10px; flex-wrap: wrap;">
                                <a href="https://snaptik.app" target="_blank" 
                                   style="padding: 10px 15px; background: var(--primary); color: white; border-radius: 8px; text-decoration: none;">
                                    Snaptik.app
                                </a>
                                <a href="https://ssstik.io" target="_blank"
                                   style="padding: 10px 15px; background: var(--secondary); color: white; border-radius: 8px; text-decoration: none;">
                                    ssstik.io
                                </a>
                                <a href="https://tikdown.org" target="_blank"
                                   style="padding: 10px 15px; background: #00ff88; color: black; border-radius: 8px; text-decoration: none;">
                                    tikdown.org
                                </a>
                            </div>
                        </div>
                    </div>
                `;
                resultsDiv.scrollIntoView({ behavior: 'smooth' });
            }
            
            hideLoading();
        }
        
        // Try multiple APIs
        async function tryMultipleAPIs(url) {
            const apis = [
                fetchTikTokVideoPrimary,
                fetchTikTokVideoFallback,
                fetchTikTokVideoAlternative
            ];
            
            for (const apiFunc of apis) {
                try {
                    const result = await apiFunc(url);
                    if (result) return result;
                } catch (error) {
                    console.log(`API failed: ${apiFunc.name}`);
                    continue;
                }
            }
            
            return null;
        }
        
        // API Functions
        async function fetchTikTokVideoPrimary(url) {
            try {
                const response = await fetch(`https://api.tiklydown.eu.org/api/download?url=${encodeURIComponent(url)}`, {
                    headers: {
                        'Accept': 'application/json',
                        'User-Agent': 'Mozilla/5.0'
                    }
                });
                
                if (!response.ok) throw new Error('API failed');
                
                const data = await response.json();
                
                return {
                    title: data.title || 'TikTok Video',
                    author: data.author || '@user',
                    thumbnail: data.cover || '',
                    duration: data.duration || '0:00',
                    views: data.play_count || 0,
                    likes: data.digg_count || 0,
                    hd: data.video?.hd || data.video?.noWatermark,
                    sd: data.video?.sd || data.video?.withWatermark,
                    watermarked: data.video?.watermark || '',
                    audio: data.music?.url || '',
                    hd_size: data.video?.hd_size || '',
                    sd_size: data.video?.sd_size || ''
                };
            } catch (error) {
                return null;
            }
        }
        
        async function fetchTikTokVideoFallback(url) {
            try {
                const response = await fetch(`https://www.tikwm.com/api/?url=${encodeURIComponent(url)}`, {
                    headers: {
                        'Accept': 'application/json'
                    }
                });
                
                const data = await response.json();
                
                if (data.code !== 0) throw new Error('API failed');
                
                return {
                    title: data.data?.title || 'TikTok Video',
                    author: `@${data.data?.author?.unique_id || 'user'}`,
                    thumbnail: data.data?.cover || '',
                    hd: data.data?.play || '',
                    watermarked: data.data?.wmplay || '',
                    audio: data.data?.music || ''
                };
            } catch (error) {
                return null;
            }
        }
        
        async function fetchTikTokVideoAlternative(url) {
            try {
                const response = await fetch('https://tikdown.org/getVideo', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                        'Accept': 'application/json'
                    },
                    body: `url=${encodeURIComponent(url)}`
                });
                
                const data = await response.json();
                
                return {
                    title: 'TikTok Video',
                    author: '@user',
                    hd: data.video_url || '',
                    watermarked: data.video_url_watermark || ''
                };
            } catch (error) {
                return null;
            }
        }
        
        // Event Listeners
        downloadBtn.addEventListener('click', downloadVideo);
        
        tiktokUrlInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                downloadVideo();
            }
        });
        
        // Auto-focus input
        tiktokUrlInput.focus();
        
        // Check URL in clipboard on page load
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                const clipboardText = await navigator.clipboard.readText();
                if (isValidTikTokUrl(clipboardText)) {
                    tiktokUrlInput.value = clipboardText;
                    // Optional: auto-download
                    // downloadVideo();
                }
            } catch (error) {
                // Clipboard access not granted or empty
            }
        });
    </script>
</body>
</html>